// Price table with categories for Israeli grocery items
// Prices are national averages in ILS

export interface Category {
  id: string;
  title: string;
  emoji: string;
  items: string[];
}

export const CATEGORIES: Category[] = [
  {
    id: "dairy",
    title: "מוצרי חלב",
    emoji: "🥛",
    items: [
      "חלב",
      "חלב דל שומן",
      "משקה שוקו",
      "גבינה לבנה",
      "קוטג'",
      "יוגורט",
      "יוגורט פרי",
      "יוגורט חלבון",
      "מארז יוגורט",
      "מעדן שוקולד",
      "חמאה",
      "שמנת",
      "שמנת לבישול",
      "גבינה צהובה",
      "גבינה צהובה פרוסה",
      "גבינה צהובה מעדניה",
      "גבינת שמנת",
      "לבן",
      "מוצרלה",
      "גבינה בולגרית",
      "שמנת מתוקה",
      "גבינת פרמזן",
      "גבינת פטה",
    ],
  },
  {
    id: "bread",
    title: "לחם ומאפייה",
    emoji: "🥖",
    items: [
      "לחם",
      "לחם מלא",
      "לחמניות",
      "פיתות",
      "חלה",
      "באגט",
      "טורטיה",
      "לחם טוסט",
      "לחמניות המבורגר",
      "קרואסון",
      "פירורי לחם",
    ],
  },
  {
    id: "eggs",
    title: "ביצים",
    emoji: "🥚",
    items: ["ביצים", "ביצים 30", "ביצים L"],
  },
  {
    id: "grains",
    title: "דגנים ופסטה",
    emoji: "🍝",
    items: [
      "אורז",
      "אורז בסמטי",
      "אורז מלא",
      "פסטה",
      "קמח",
      "קמח תופח",
      "בורגול",
      "קוסקוס",
      "קינואה",
      "שיבולת שועל",
      "קורנפלקס",
      "כריות",
      "גרנולה",
      "נודלס",
      "אטריות",
      "ספגטי",
      "פתיתים",
    ],
  },
  {
    id: "oils",
    title: "שמנים ותבלינים",
    emoji: "🫙",
    items: [
      "שמן זית",
      "שמן קנולה",
      "שמן",
      "שמן חמניות",
      "חומץ",
      "מיונז",
      "קטשופ",
      "חרדל",
      "טחינה",
      "טחינה גולמית",
      "סויה",
      "רוטב עגבניות",
      "רוטב סלט",
      "רסק עגבניות",
      "חמאת בוטנים",
      "קארי",
    ],
  },
  {
    id: "baking",
    title: "אפייה ומתוקים",
    emoji: "🍯",
    items: ["סוכר", "סוכר חום", "דבש", "סילאן", "ממרח שוקולד", "ריבה", "מייפל", "אבקת אפייה", "סוכר וניל"],
  },
  {
    id: "canned",
    title: "שימורים",
    emoji: "🥫",
    items: [
      "טונה",
      "מארז טונה",
      "תירס",
      "זיתים",
      "זיתים שחורים",
      "חומוס מוכן",
      "סלט חצילים",
      "עגבניות מרוסקות",
      "שעועית",
      "אפונה",
      "מלפפון חמוץ",
      "פטריות משומרות",
    ],
  },
  {
    id: "beverages",
    title: "משקאות",
    emoji: "🧃",
    items: [
      "קפה",
      "טסטרס צ'ויס",
      "קפה שחור",
      "קפסולות קפה",
      "תה",
      "מים",
      "קולה",
      "מיץ תפוזים",
      "מיץ",
      "סירופ פטל",
      "סודה",
      "בירה",
      "יין",
      "משקה אנרגיה",
    ],
  },
  {
    id: "meat",
    title: "בשר ועוף",
    emoji: "🍗",
    items: [
      "עוף",
      "חזה עוף",
      "שניצל",
      "בשר טחון",
      "בשר",
      "נקניקיות",
      "נקניק",
      "קבב",
      "המבורגר",
      "כרעיים",
      "כנפיים",
      "פרגיות",
      "כבד עוף",
    ],
  },
  {
    id: "fish",
    title: "דגים",
    emoji: "🐟",
    items: ["דגים", "סלמון", "דג", "טונה טרייה", "פילה סלמון קפוא", "אמנון"],
  },
  {
    id: "fruits",
    title: "פירות",
    emoji: "🍎",
    items: [
      "תפוחים",
      "תפוח",
      "בננות",
      "בננה",
      "תפוזים",
      "קלמנטינות",
      "ענבים",
      "אבטיח",
      "מלון",
      "אגס",
      "שזיף",
      "אפרסק",
      "נקטרינה",
      "לימון",
      "אבוקדו",
      "מנגו",
      "תות",
      "אוכמניות",
      "רימון",
      "אשכולית",
      "פומלה",
    ],
  },
  {
    id: "vegetables",
    title: "ירקות",
    emoji: "🥦",
    items: [
      "עגבניות",
      "עגבניה",
      "מלפפונים",
      "מלפפון",
      "בצל",
      "בצל סגול",
      "תפוחי אדמה",
      "תפוח אדמה",
      "גזר",
      "חסה",
      "כרוב",
      "כרוב אדום",
      "פלפל",
      "פלפל ירוק",
      "פלפל חריף",
      "חציל",
      "קישוא",
      "ברוקולי",
      "כרובית",
      "שום",
      "פטריות",
      "בטטה",
      "סלרי",
      "שמיר",
      "כוסברה",
      "פטרוזיליה",
      "נענע",
      "בזיליקום",
      "תרד",
      "רוקט",
      "צנונית",
      "דלעת",
      "סלק",
    ],
  },
  {
    id: "snacks",
    title: "נשנושים",
    emoji: "🍫",
    items: [
      "במבה",
      "ביסלי",
      "צ'יפס",
      "שוקולד",
      "עוגיות",
      "קרקר",
      "אגוזים",
      "שקדים",
      "צימוקים",
      "חטיף",
      "חטיף אנרגיה",
      "גלידה",
      "פופקורן",
      "ופלים",
      "בייגלה",
    ],
  },
  {
    id: "frozen",
    title: "קפואים",
    emoji: "🧊",
    items: [
      "שעועית ירוקה קפואה",
      "אפונה קפואה",
      "תירס קפוא",
      "פיצה קפואה",
      "בורקס",
      "שניצל קפוא",
      "צ'יפס קפוא",
      "ג'חנון",
      "מלוואח",
    ],
  },
  {
    id: "household",
    title: "ניקיון ובית",
    emoji: "🧼",
    items: [
      "נייר טואלט",
      "נייר סופג",
      "מגבונים",
      "סבון ידיים",
      "שמפו",
      "מרכך",
      "תחליב רחצה",
      "דאודורנט",
      "סכיני גילוח",
      "משחת שיניים",
      "נוזל כלים",
      "אקונומיקה",
      "נוזל רצפות",
      "מסיר שומנים",
      "סבון אסלה",
      "מטליות",
      "סחבות רצפה",
      "שקיות אשפה",
      "נייר כסף",
      "נייר אפייה",
      "ניילון נצמד",
      "שקיות כריכים",
      "ספוגים",
      "אבקת כביסה",
      "ג'ל כביסה",
      "קפסולות כביסה",
      "מרכך כביסה",
      "צמר גפן",
      "מקלות אוזניים",
    ],
  },
  {
    id: "baby",
    title: "תינוקות",
    emoji: "👶",
    items: ["חיתולים", "מגבונים לחים", "פורמולה", "דייסה"],
  },
  {
    id: "spices",
    title: "תבלינים",
    emoji: "🌶️",
    items: ["מלח", "מלח גס", "פלפל שחור", "פפריקה", "כורכום", "כמון", "קינמון", "אורגנו", "מרק עוף"],
  },
  {
    id: "legumes",
    title: "קטניות",
    emoji: "🫘",
    items: ["עדשים", "עדשים כתומות", "חומוס יבש", "גרגירי חומוס", "שעועית אדומה", "שעועית לבנה"],
  },
];

// Price table - exact values from user
export const PRICE_TABLE: Record<string, number> = {
  // --- Dairy ---
  חלב: 8.9,
  "חלב דל שומן": 6.4,
  "משקה שוקו": 13.9,
  "גבינה לבנה": 7.9,
  "קוטג'": 7.5,
  יוגורט: 4.9,
  "יוגורט פרי": 5.5,
  "יוגורט חלבון": 6.5,
  "מארז יוגורט": 21.9,
  "מעדן שוקולד": 3.9,
  חמאה: 9.9,
  שמנת: 6.9,
  "שמנת לבישול": 8.9,
  "גבינה צהובה": 12.9,
  "גבינה צהובה פרוסה": 15.9,
  "גבינה צהובה מעדניה": 5.5,
  "גבינת שמנת": 8.9,
  לבן: 5.9,
  מוצרלה: 14.9,
  "גבינה בולגרית": 9.9,
  "שמנת מתוקה": 9.9,
  "גבינת פרמזן": 18.9,
  "גבינת פטה": 16.9,

  // --- Bread & Bakery ---
  לחם: 10.9,
  "לחם מלא": 14.9,
  לחמניות: 12.9,
  פיתות: 8.9,
  חלה: 14.9,
  באגט: 9.9,
  טורטיה: 11.9,
  "לחם טוסט": 11.9,
  "לחמניות המבורגר": 9.9,
  קרואסון: 6.9,
  "פירורי לחם": 6.9,

  // --- Eggs ---
  ביצים: 12.9,
  "ביצים 30": 27.9,
  "ביצים L": 13.9,

  // --- Grains & Pasta ---
  אורז: 12.9,
  "אורז בסמטי": 14.9,
  "אורז מלא": 13.9,
  פסטה: 6.9,
  קורנפלקס: 18.3,
  קמח: 8.9,
  "קמח תופח": 6.9,
  בורגול: 9.9,
  קוסקוס: 8.9,
  קינואה: 14.9,
  "שיבולת שועל": 14.9,
  קורנפלקס: 18.9,
  כריות: 22.9,
  גרנולה: 24.9,
  נודלס: 5.9,
  אטריות: 9.9,
  ספגטי: 6.9,
  פתיתים: 7.9,

  // --- Oils & Condiments ---
  "שמן זית": 32.9,
  "שמן קנולה": 14.9,
  שמן: 14.9,
  "שמן חמניות": 11.9,
  חומץ: 8.9,
  מיונז: 12.9,
  קטשופ: 9.9,
  חרדל: 7.9,
  טחינה: 14.9,
  "טחינה גולמית": 15.9,
  סויה: 9.9,
  "רוטב עגבניות": 7.9,
  "רוטב סלט": 11.9,
  "רסק עגבניות": 9.9,
  "חמאת בוטנים": 18.9,
  קארי: 20.9,

  // --- Sweeteners & Baking ---
  סוכר: 7.9,
  "סוכר חום": 9.9,
  דבש: 24.9,
  סילאן: 19.9,
  "ממרח שוקולד": 16.9,
  ריבה: 12.9,
  מייפל: 19.9,
  "אבקת אפייה": 3.9,
  "סוכר וניל": 3.9,

  // --- Canned & Preserved ---
  טונה: 10.9,
  "מארז טונה": 24.9,
  תירס: 7.9,
  זיתים: 12.9,
  "זיתים שחורים": 7.9,
  "חומוס מוכן": 9.9,
  "סלט חצילים": 12.9,
  "עגבניות מרוסקות": 6.9,
  שעועית: 7.9,
  אפונה: 6.9,
  "מלפפון חמוץ": 9.9,
  "פטריות משומרות": 9.9,

  // --- Beverages ---
  קפה: 24.9,
  "טסטרס צ'ויס": 35.9,
  "קפה שחור": 6.9,
  "קפסולות קפה": 12.9,
  תה: 14.9,
  מים: 6.9,
  קולה: 8.9,
  "מיץ תפוזים": 12.9,
  מיץ: 10.9,
  "סירופ פטל": 14.9,
  סודה: 5.9,
  בירה: 9.9,
  יין: 39.9,
  "משקה אנרגיה": 8.9,

  // --- Meat & Poultry ---
  עוף: 34.9,
  "חזה עוף": 44.9,
  שניצל: 39.9,
  "בשר טחון": 49.9,
  בשר: 69.9,
  נקניקיות: 24.9,
  נקניק: 19.9,
  קבב: 44.9,
  המבורגר: 39.9,
  כרעיים: 29.9,
  כנפיים: 32.9,
  פרגיות: 38.9,
  "כבד עוף": 24.9,

  // --- Fish ---
  דגים: 59.9,
  סלמון: 89.9,
  דג: 49.9,
  "טונה טרייה": 69.9,
  "פילה סלמון קפוא": 79.9,
  אמנון: 29.9,

  // --- Fruits ---
  תפוחים: 12.9,
  תפוח: 12.9,
  בננות: 9.9,
  בננה: 9.9,
  תפוזים: 9.9,
  קלמנטינות: 12.9,
  ענבים: 19.9,
  אבטיח: 14.9,
  מלון: 12.9,
  אגס: 14.9,
  שזיף: 16.9,
  אפרסק: 16.9,
  נקטרינה: 16.9,
  לימון: 9.9,
  אבוקדו: 8.9,
  מנגו: 12.9,
  תות: 24.9,
  אוכמניות: 29.9,
  רימון: 12.9,
  אשכולית: 6.9,
  פומלה: 7.9,

  // --- Vegetables ---
  עגבניות: 9.9,
  עגבניה: 9.9,
  מלפפונים: 8.9,
  מלפפון: 8.9,
  בצל: 6.9,
  "בצל סגול": 7.9,
  "תפוחי אדמה": 6.9,
  "תפוח אדמה": 6.9,
  גזר: 6.9,
  חסה: 7.9,
  כרוב: 6.9,
  "כרוב אדום": 6.9,
  פלפל: 12.9,
  "פלפל ירוק": 8.9,
  "פלפל חריף": 12.9,
  חציל: 9.9,
  קישוא: 8.9,
  ברוקולי: 14.9,
  כרובית: 12.9,
  שום: 4.9,
  פטריות: 14.9,
  בטטה: 9.9,
  סלרי: 8.9,
  שמיר: 4.9,
  כוסברה: 4.9,
  פטרוזיליה: 4.9,
  נענע: 4.9,
  בזיליקום: 6.9,
  תרד: 9.9,
  רוקט: 9.9,
  צנונית: 5.9,
  דלעת: 6.9,
  סלק: 5.9,

  // --- Snacks ---
  במבה: 6.9,
  ביסלי: 6.9,
  "צ'יפס": 9.9,
  שוקולד: 8.9,
  עוגיות: 12.9,
  קרקר: 8.9,
  אגוזים: 29.9,
  שקדים: 34.9,
  צימוקים: 14.9,
  חטיף: 5.9,
  "חטיף אנרגיה": 17.9,
  גלידה: 24.9,
  פופקורן: 9.9,
  ופלים: 10.9,
  בייגלה: 9.9,

  // --- Frozen ---
  "שעועית ירוקה קפואה": 12.9,
  "אפונה קפואה": 11.9,
  "תירס קפוא": 11.9,
  "פיצה קפואה": 24.9,
  בורקס: 29.9,
  "שניצל קפוא": 34.9,
  "צ'יפס קפוא": 14.9,
  "ג'חנון": 14.9,
  מלוואח: 14.9,

  // --- Household & Cleaning ---
  "נייר טואלט": 29.9,
  "נייר סופג": 13.5,
  מגבונים: 14.9,
  "סבון ידיים": 12.9,
  שמפו: 19.9,
  מרכך: 16.9,
  "תחליב רחצה": 16.9,
  דאודורנט: 16.9,
  "סכיני גילוח": 19.9,
  "משחת שיניים": 11.9,
  "נוזל כלים": 12.9,
  אקונומיקה: 9.9,
  "נוזל רצפות": 16.9,
  "מסיר שומנים": 12.9,
  "סבון אסלה": 12.9,
  מטליות: 14.9,
  "סחבות רצפה": 12.9,
  "שקיות אשפה": 16.9,
  "נייר כסף": 14.9,
  "נייר אפייה": 9.9,
  "ניילון נצמד": 9.9,
  "שקיות כריכים": 9.9,
  ספוגים: 9.9,
  "אבקת כביסה": 34.9,
  "ג'ל כביסה": 34.9,
  "קפסולות כביסה": 39.9,
  "מרכך כביסה": 19.9,
  "צמר גפן": 5.9,
  "מקלות אוזניים": 5.9,

  // --- Baby ---
  חיתולים: 59.9,
  "מגבונים לחים": 12.9,
  פורמולה: 59.9,
  דייסה: 19.9,

  // --- Spices ---
  מלח: 4.9,
  "מלח גס": 3.5,
  "פלפל שחור": 9.9,
  פפריקה: 8.9,
  כורכום: 8.9,
  כמון: 8.9,
  קינמון: 9.9,
  אורגנו: 8.9,
  "מרק עוף": 14.9,

  // --- Legumes ---
  עדשים: 12.9,
  "עדשים כתומות": 11.9,
  "חומוס יבש": 14.9,
  "גרגירי חומוס": 14.9,
  "שעועית אדומה": 12.9,
  "שעועית לבנה": 13.9,
};

// Other category for unrecognized items
export const OTHER_CATEGORY: Category = {
  id: "other",
  title: "אחר",
  emoji: "🧺",
  items: [],
};

// Build a map from item name to category for fast lookups
const itemToCategoryMap = new Map<string, Category>();
CATEGORIES.forEach((category) => {
  category.items.forEach((item) => {
    itemToCategoryMap.set(item.toLowerCase(), category);
  });
});

// Normalize text for matching
export function normalizeItemName(name: string): string {
  return name.trim().toLowerCase().replace(/\s+/g, " ").trim();
}

// Get estimated price for an item
export function getEstimatedPrice(itemName: string): number | null {
  const normalized = normalizeItemName(itemName);

  // Check direct match
  for (const [key, price] of Object.entries(PRICE_TABLE)) {
    if (normalizeItemName(key) === normalized) {
      return price;
    }
  }

  // Check partial match
  for (const [key, price] of Object.entries(PRICE_TABLE)) {
    const keyNormalized = normalizeItemName(key);
    if (normalized.includes(keyNormalized) || keyNormalized.includes(normalized)) {
      return price;
    }
  }

  return null;
}

// Get category for an item
export function getItemCategory(itemName: string): Category {
  const normalized = normalizeItemName(itemName);

  // Direct match
  const directMatch = itemToCategoryMap.get(normalized);
  if (directMatch) return directMatch;

  // Partial match - check if item contains or is contained by a known item
  for (const [key, category] of itemToCategoryMap.entries()) {
    if (normalized.includes(key) || key.includes(normalized)) {
      return category;
    }
  }

  return OTHER_CATEGORY;
}

// Get all categories in display order (including other at the end)
export function getAllCategories(): Category[] {
  return [...CATEGORIES, OTHER_CATEGORY];
}
